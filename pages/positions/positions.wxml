<!--pages/positions/positions.wxml-->
<view class="container">
  <!-- èµ„äº§æ¦‚è§ˆå¡ç‰‡ -->
  <view class="gradient-header">
    <view class="stat-row">
      <view class="stat-item">
        <view class="stat-icon">ğŸ’°</view>
        <view class="stat-label">æ€»èµ„äº§</view>
        <view class="stat-value">Â¥{{totalMarketValue}}</view>
      </view>
      <view class="stat-item">
        <view class="stat-icon" wx:if="{{totalUnrealizedPL >= 0}}">ğŸ“ˆ</view>
        <view class="stat-icon" wx:else>ğŸ“‰</view>
        <view class="stat-label">ä»Šæ—¥ç›ˆäº</view>
        <view class="stat-value {{totalUnrealizedPL >= 0 ? 'text-green' : 'text-red'}}">
          {{totalUnrealizedPL >= 0 ? '+' : ''}}Â¥{{totalUnrealizedPL}}
        </view>
      </view>
    </view>
    
    <view class="stat-row" style="margin-top: 32rpx; padding-top: 32rpx; border-top: 1px solid rgba(255,255,255,0.2);">
      <view class="stat-item">
        <view class="stat-label">æŒä»“æ•°</view>
        <view class="stat-value">{{positions.length}}</view>
      </view>
      <view class="stat-item">
        <view class="stat-label">æ€»æˆæœ¬</view>
        <view class="stat-value">Â¥{{totalCost}}</view>
      </view>
      <view class="stat-item">
        <view class="stat-label">ç›ˆäºæ¯”</view>
        <view class="stat-value {{returnRate >= 0 ? 'text-green' : 'text-red'}}">
          {{returnRate}}%
        </view>
      </view>
    </view>
  </view>

  <!-- æŒä»“åˆ—è¡¨ -->
  <view wx:if="{{positions.length === 0}}" class="empty-state">
    <view class="icon">ğŸ“Š</view>
    <view class="text">æš‚æ— æŒä»“æ•°æ®</view>
  </view>

  <view wx:else>
    <view class="section-title">æŒä»“æ˜ç»† ({{positions.length}})</view>
    
    <view class="position-list">
      <view 
        class="list-item" 
        wx:for="{{positions}}" 
        wx:key="{{item.stockCode}}"
        bindtap="onPositionTap"
        data-position="{{item}}"
      >
        <view class="avatar">{{item.stockCode.substr(0,2)}}</view>
        <view class="content">
          <view class="title">{{item.stockCode}} {{item.stockName}}</view>
          <view class="subtitle">
            æŒä»“: {{item.totalQuantity}} è‚¡ | æˆæœ¬: Â¥{{item.averagePrice}}
          </view>
          <view class="desc">{{item.userName}}</view>
        </view>
        <view class="right">
          <view class="amount">Â¥{{item.totalCost}}</view>
          <view 
            class="change {{item.unrealizedPL >= 0 ? 'text-green' : 'text-red'}}"
            wx:if="{{item.currentPrice}}"
          >
            {{item.unrealizedPL >= 0 ? '+' : ''}}{{item.unrealizedPLPercent}}%
          </view>
          <view class="change text-gray" wx:else>
            æœªè®¾ä»·æ ¼
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- æµ®åŠ¨æ·»åŠ æŒ‰é’® -->
  <view class="fab" bindtap="onAddTransaction">+</view>
</view>
